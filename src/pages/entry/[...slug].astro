---
import EntryLayout from '../../layouts/EntryLayout.astro';
import EntryCard from '../../components/EntryCard.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const entries = await getCollection('entries', ({ data }) => !data.draft);
  const sorted = entries.sort(
    (a, b) => new Date(a.data.date).getTime() - new Date(b.data.date).getTime()
  );

  return sorted.map((entry, index) => ({
    params: { slug: entry.id },
    props: {
      entry,
      prev: index > 0 ? sorted[index - 1] : null,
      next: index < sorted.length - 1 ? sorted[index + 1] : null,
    },
  }));
}

const { entry, prev, next } = Astro.props;
---

<EntryLayout entry={entry} prev={prev} next={next}>
  <EntryCard entry={entry} />
</EntryLayout>
